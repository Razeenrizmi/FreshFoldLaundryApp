<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Dashboard - LaundryApp</title>
    <link rel="stylesheet" href="/css/customer-dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-brand">
            <h2>FreshFold Customer</h2>
        </div>
        <div class="navbar-menu">
            <a href="/profile" class="nav-link">Profile</a>
            <a href="/order/browse" class="nav-link">New Order</a>
            <div class="user-profile">
                <i class="fas fa-user-circle"></i>
                <span>Customer</span>
                <form th:action="@{/logout}" method="post" style="display: inline;">
                    <button type="submit" class="logout-btn">Logout</button>
                </form>
            </div>
        </div>
    </nav>

    <!-- Main Dashboard Content -->
    <div class="dashboard-container">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <h1>Customer Dashboard</h1>

            <!-- Welcome Message -->
            <div class="welcome-message">
                <h2>Welcome back!</h2>
                <p>Manage your laundry orders and track your service history</p>
            </div>
        </div>

        <!-- Success/Error Messages -->
        <div th:if="${success}" class="section-card" style="background: #d1fae5; border-left: 4px solid #10b981; margin-bottom: 1rem;">
            <div style="padding: 1rem;">
                <p style="color: #059669; font-weight: 600;" th:text="${success}"></p>
            </div>
        </div>
        <div th:if="${error}" class="section-card" style="background: #fee2e2; border-left: 4px solid #ef4444; margin-bottom: 1rem;">
            <div style="padding: 1rem;">
                <p style="color: #dc2626; font-weight: 600;" th:text="${error}"></p>
            </div>
        </div>
        <div th:if="${successMessage}" class="section-card" style="background: #d1fae5; border-left: 4px solid #10b981; margin-bottom: 1rem;">
            <div style="padding: 1rem;">
                <p style="color: #059669; font-weight: 600;" th:text="${successMessage}"></p>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-cards">
            <div class="stat-card">
                <div class="stat-icon pending">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-info">
                    <h3 th:text="${pendingOrders != null ? #lists.size(pendingOrders) : 0}">0</h3>
                    <p>Pending Orders</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon progress">
                    <i class="fas fa-spinner"></i>
                </div>
                <div class="stat-info">
                    <h3 th:text="${inProgressOrders != null ? #lists.size(inProgressOrders) : 0}">0</h3>
                    <p>In Progress</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon completed">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-info">
                    <h3 th:text="${completedOrders != null ? #lists.size(completedOrders) : 0}">0</h3>
                    <p>Completed</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon total">
                    <i class="fas fa-list"></i>
                </div>
                <div class="stat-info">
                    <h3 th:text="${orders != null ? #lists.size(orders) : 0}">0</h3>
                    <p>Total Orders</p>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="action-cards">
            <div class="action-card">
                <i class="fas fa-plus-circle"></i>
                <h3>New Order</h3>
                <p>Place a new laundry order and select your preferred services</p>
                <!-- Updated: Changed from /orders/index to /order/browse -->
                <a href="/order/browse" class="action-btn">Place Order</a>
            </div>
            <div class="action-card">
                <i class="fas fa-user-edit"></i>
                <h3>Edit Profile</h3>
                <p>Update your personal information and delivery preferences</p>
                <a href="/profile" class="action-btn">Edit Profile</a>
            </div>
        </div>

        <!-- Orders Section -->
        <div class="section-card">
            <div class="section-header">
                <h2><i class="fas fa-list-alt"></i> My Orders</h2>
                <span class="section-count" th:text="${orders != null ? #lists.size(orders) + ' orders' : '0 orders'}">0 orders</span>
            </div>
            <div class="table-container">
                <table class="data-table" th:if="${orders != null and !#lists.isEmpty(orders)}">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Service</th>
                            <th>Special Instructions</th>
                            <th>Status</th>
                            <th>Amount</th>
                            <th>Order Date</th>
                            <th>Pickup Date</th>
                            <th>Delivery Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="order : ${orders}" class="clickable-order-row"
                            th:onclick="'window.location.href=\'/track?orderId=' + ${order.orderId} + '\''">
                            <td th:text="'#' + ${order.orderId}">#001</td>
                            <td>
                                <div class="service-info">
                                    <span th:text="${order.serviceType}">Wash & Fold</span>
                                    <small th:text="${order.clothType}">Mixed Items</small>
                                </div>
                            </td>
                            <td>
                                <div class="instructions-cell">
                                    <span th:if="${order.specialInstructions != null and !#strings.isEmpty(order.specialInstructions)}"
                                          th:text="${order.specialInstructions}"
                                          class="instructions-text">Special instructions</span>
                                    <span th:if="${order.specialInstructions == null or #strings.isEmpty(order.specialInstructions)}"
                                          class="no-instructions">No special instructions</span>
                                </div>
                            </td>
                            <td>
                                <span class="status-badge"
                                      th:classappend="${order.status != null ? (order.status.toLowerCase().replace('_', '-').replace(' ', '-')) : 'pending'}"
                                      th:text="${order.status}">Pending</span>
                            </td>
                            <td class="amount" th:text="${order.price != null ? 'Rs ' + order.price : 'Rs 0.00'}">Rs 450.00</td>
                            <td>
                                <div class="date-cell">
                                    <span th:if="${order.orderDate != null}"
                                          th:text="${#temporals.format(order.orderDate, 'dd/MM/yyyy')}"
                                          class="date-value">25/09/2025</span>
                                    <span th:if="${order.orderDate == null}"
                                          class="date-na">Not set</span>
                                </div>
                            </td>
                            <td>
                                <div class="date-cell">
                                    <span th:if="${order.pickupDate != null}"
                                          th:text="${#temporals.format(order.pickupDate, 'dd/MM/yyyy')}"
                                          class="date-value">26/09/2025</span>
                                    <span th:if="${order.pickupDate == null}"
                                          class="date-na">Not set</span>
                                </div>
                            </td>
                            <td>
                                <div class="date-cell">
                                    <span th:if="${order.deliveryDate != null}"
                                          th:text="${#temporals.format(order.deliveryDate, 'dd/MM/yyyy')}"
                                          class="date-value">28/09/2025</span>
                                    <span th:if="${order.deliveryDate == null}"
                                          class="date-na">Not set</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="empty-state" th:if="${orders == null or #lists.isEmpty(orders)}">
                    <i class="fas fa-inbox"></i>
                    <p>No orders found. Ready to place your first order?</p>
                    <a href="/orders/index" class="action-btn" style="margin-top: 1rem;">Place Your First Order</a>
                </div>
            </div>
        </div>
    </div>
</body>
</html>